<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!--
  ~ Copyright 2020 Haulmont.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<window xmlns="http://jmix.io/schema/ui/window"
        caption="msg://editorCaption"
        focusComponent="mainParams">
    <data>
        <instance id="mailBoxDc"
                  class="io.jmix.imap.entity.ImapMailBox"
                  fetchPlan="imap-mailbox-edit">
            <loader id="mailBoxLoader"/>
            <instance id="authenticationDc" property="authentication"/>
            <instance id="proxyDc" property="proxy"/>
            <collection id="foldersDc" property="folders">
                <collection id="eventsDc" property="events">
                    <collection id="handlersDc" property="eventHandlers"/>
                </collection>
            </collection>
        </instance>
    </data>

    <facets>
        <dataLoadCoordinator auto="true"/>
    </facets>

    <layout spacing="true" expand="scrollBox">
        <scrollBox id="scrollBox"
                   spacing="true">
            <hbox spacing="true">
                <groupBox caption="msg://basicConfigurationCaption"
                          spacing="true" width="AUTO">
                    <form id="mainParams" dataContainer="mailBoxDc">
                        <column width="250px">
                            <textField id="name" property="name"/>
                            <textField id="host" property="host"/>
                            <textField id="port" property="port">
                                <numberFormatter format="#####"/>
                            </textField>
                            <field property="secureMode"/>
                            <field id="mailBoxRootCertificateField" property="rootCertificate"/>
                            <textField dataContainer="authenticationDc" property="username"/>
                            <passwordField caption="msg://passwordFieldCaption"
                                           dataContainer="authenticationDc"
                                           maxLength="128"
                                           property="password"
                                           required="true"/>
                        </column>
                    </form>
                    <button id="checkConnectionBtn"
                            caption="msg://checkConnectionCaption"/>
                </groupBox>
                <vbox spacing="true"
                      width="500px">
                    <groupBox caption="msg://advancedConfigurationCaption"
                              spacing="true"
                              width="AUTO">
                        <form id="advancedParams"
                              dataContainer="mailBoxDc">
                            <column childrenCaptionWidth="222"
                                    width="300px">
                                <textField id="jmixFlagTextField"
                                           description="msg://jmixFlagDescription"
                                           property="jmixFlag"/>
                                <checkBox id="useTrashFolderChkBox"
                                          caption="msg://useTrashFolderForRemovalCaption"/>
                                <entityPicker id="trashFolderEntityPicker"
                                              property="trashFolder"/>
                                <checkBox id="useCustomEventsGeneratorChkBox"
                                          caption="msg://useCustomEventsGeneratorCaption"/>
                                <comboBox id="customEventsGeneratorClassLookup"
                                          property="eventsGeneratorClass"/>
                                <checkBox id="useProxyChkBox"
                                          caption="msg://useProxyCaption"/>
                            </column>
                        </form>
                    </groupBox>
                    <groupBox caption="msg://proxyConfigurationCaption"
                              spacing="true"
                              width="AUTO">
                        <form id="proxyParams"
                              dataContainer="proxyDc">
                            <column childrenCaptionWidth="222"
                                    width="300px">
                                <textField id="proxyHostField"
                                           caption="msg://proxyHostCaption"
                                           property="host"/>
                                <textField id="proxyPortField"
                                           caption="msg://proxyPortCaption"
                                           property="port">
                                    <numberFormatter format="#####"/>
                                </textField>
                                <checkBox id="webProxyChkBox"
                                           caption="msg://proxyUseWebCaption"
                                           property="webProxy"/>
                            </column>
                        </form>
                    </groupBox>
                </vbox>
            </hbox>
            <split id="foldersPane"
                   height="100%"
                   orientation="horizontal"
                   pos="80"
                   width="100%">
                <vbox id="tablePane"
                      height="300px"
                      margin="false,true,false,false">
                    <treeTable id="foldersTable"
                               editable="true"
                               height="100%"
                               sortable="false"
                               width="100%" dataContainer="foldersDc" hierarchyProperty="parent">
                        <actions>
                            <action id="refresh" type="refresh"/>
                            <action id="enableSingle"
                                    caption="msg://enableSingleCaption"/>
                            <action id="enableWithChildren"
                                    caption="msg://enableWithChildrenCaption"/>
                            <action id="disableSingle"
                                    caption="msg://disableSingleCaption"/>
                            <action id="disableWithChildren"
                                    caption="msg://disableWithChildrenCaption"/>
                        </actions>
                        <columns>
                            <column id="name"/>
                            <column id="selected" caption="" editable="true"/>
                        </columns>
                        <rows/>
                        <buttonsPanel>
                            <button action="foldersTable.refresh"/>
                        </buttonsPanel>
                    </treeTable>
                </vbox>
                <vbox height="100%"
                      margin="false,false,false,true">
                    <groupBox caption="msg://eventsCaption"
                              height="100%">
                        <vbox id="selectedFolderPanel"
                              height="100%"
                              visible="false">
                            <scrollBox id="editEventsContainer"
                                       height="100%">
                                <gridLayout id="editEventsGrid"
                                            margin="true"
                                            width="100%">
                                    <columns count="2"/>
                                    <rows>
                                        <row>
                                            <label value="msg://allEvents"/>
                                            <checkBox id="allEventsChkBox" align="MIDDLE_CENTER"/>
                                        </row>
                                    </rows>
                                </gridLayout>
                            </scrollBox>
                        </vbox>
                    </groupBox>
                </vbox>
            </split>
        </scrollBox>
        <hbox id="editActions" spacing="true">
            <button action="windowCommitAndClose"/>
            <button action="windowClose"/>
        </hbox>
    </layout>
</window>
